/*!
 * CanJS - 2.0.0
 * http://canjs.us/
 * Copyright (c) 2013 Bitovi
 * Fri, 25 Oct 2013 02:40:43 GMT
 * Licensed MIT
 * Includes: can/component/component.js,can/construct/construct.js,can/observe/observe.js,can/compute/compute.js,can/model/model.js,can/view/view.js,can/control/control.js,can/route/route.js,can/control/route/route.js,can/util/string/string.js,can/view/mustache/mustache.js,can/view/ejs/ejs.js,can/model/queue/queue.js,can/map/backup/backup.js,can/view/modifiers/modifiers.js,can/util/object/object.js,can/util/fixture/fixture.js
 * Download from: http://bitbuilder.herokuapp.com/can.custom.js?configuration=jquery&minify=true&plugins=can%2Fcomponent%2Fcomponent.js&plugins=can%2Fconstruct%2Fconstruct.js&plugins=can%2Fobserve%2Fobserve.js&plugins=can%2Fcompute%2Fcompute.js&plugins=can%2Fmodel%2Fmodel.js&plugins=can%2Fview%2Fview.js&plugins=can%2Fcontrol%2Fcontrol.js&plugins=can%2Froute%2Froute.js&plugins=can%2Fcontrol%2Froute%2Froute.js&plugins=can%2Futil%2Fstring%2Fstring.js&plugins=can%2Fview%2Fmustache%2Fmustache.js&plugins=can%2Fview%2Fejs%2Fejs.js&plugins=can%2Fmodel%2Fqueue%2Fqueue.js&plugins=can%2Fmap%2Fbackup%2Fbackup.js&plugins=can%2Fview%2Fmodifiers%2Fmodifiers.js&plugins=can%2Futil%2Fobject%2Fobject.js&plugins=can%2Futil%2Ffixture%2Ffixture.js
 */
(function(undefined){var __m4=function(){var t=window.can||{};("undefined"==typeof GLOBALCAN||GLOBALCAN!==!1)&&(window.can=t),t.isDeferred=function(t){var e=this.isFunction;return t&&e(t.then)&&e(t.pipe)};var e=0;return t.cid=function(t,n){return t._cid?t._cid:t._cid=(n||"")+ ++e},t.VERSION="@EDGE",t}(),__m5=function(t){return t.each=function(t,e,n){var r,i=0;if(t)if("number"==typeof t.length&&t.pop)for(t.attr&&t.attr("length"),r=t.length;r>i&&e.call(n||t[i],t[i],i,t)!==!1;i++);else if(t.hasOwnProperty)for(r in t)if(t.hasOwnProperty(r)&&e.call(n||t[r],t[r],r,t)===!1)break;return t},t}(__m4),__m6=function(t){t.inserted=function(e){for(var n,r,i=!1,a=0;(r=e[a])!==undefined;a++){if(!i){if(!r.getElementsByTagName)continue;if(!t.has(t.$(document),r).length)return;i=!0}if(i&&r.getElementsByTagName){t.trigger(r,"inserted",[],!1),n=t.makeArray(r.getElementsByTagName("*"));for(var u,s=0;(u=n[s])!==undefined;s++)t.trigger(u,"inserted",[],!1)}}},t.appendChild=function(e,n){if(11===n.nodeType)var r=t.makeArray(n.childNodes);else var r=[n];e.appendChild(n),t.inserted(r)},t.insertBefore=function(e,n,r){if(11===n.nodeType)var i=t.makeArray(n.childNodes);else var i=[n];e.insertBefore(n,r),t.inserted(i)}}(__m4),__m2=function(t,e){t.extend(e,t,{trigger:function(e,n,r){e.trigger?e.trigger(n,r):t.event.trigger(n,r,e,!0)},addEvent:function(e,n){return t([this]).bind(e,n),this},removeEvent:function(e,n){return t([this]).unbind(e,n),this},buildFragment:function(e,n){var r,i=t.buildFragment;return e=[e],n=n||document,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,r=i.call(jQuery,e,n),r.cacheable?t.clone(r.fragment):r.fragment||r},$:t,each:e.each}),t.each(["bind","unbind","undelegate","delegate"],function(n,r){e[r]=function(){var e=this[r]?this:t([this]);return e[r].apply(e,arguments),this}}),e.on=e.bind,e.off=e.unbind,t.each(["append","filter","addClass","remove","data","get","has"],function(t,n){e[n]=function(t){return t[n].apply(t,e.makeArray(arguments).slice(1))}});var n=t.cleanData;t.cleanData=function(r){t.each(r,function(t,n){n&&e.trigger(n,"removed",[],!1)}),n(r)};var r=t.fn.domManip;return t.fn.domManip=function(t,n,i){return r.call(this,t,n,function(t){if(11===t.nodeType)var n=e.makeArray(t.childNodes);var r=i.apply(this,arguments);return e.inserted(n?n:[t]),r})},t.event.special.inserted={},t.event.special.removed={},e}(jQuery,__m4,__m5,__m6),__m9=function(t){var e=/_|-/,n=/\=\=/,r=/([A-Z]+)([A-Z][a-z])/g,i=/([a-z\d])([A-Z])/g,a=/([a-z\d])([A-Z])/g,u=/\{([^\}]+)\}/g,s=/"/g,o=/'/g,c=function(t,e,n){var r=t[e];return r===undefined&&n===!0&&(r=t[e]={}),r},f=function(t){return/^f|^o/.test(typeof t)};return t.extend(t,{esc:function(t){var e=null===t||t===undefined||isNaN(t)&&"NaN"==""+t;return(""+(e?"":t)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(s,"&#34;").replace(o,"&#39;")},getObject:function(e,n,r){var i,a,u,s,o=e?e.split("."):[],l=o.length,h=0;if(n=t.isArray(n)?n:[n||window],s=n.length,!l)return n[0];for(h;s>h;h++){for(i=n[h],u=undefined,a=0;l>a&&f(i);a++)u=i,i=c(u,o[a]);if(u!==undefined&&i!==undefined)break}if(r===!1&&i!==undefined&&delete u[o[a-1]],r===!0&&i===undefined)for(i=n[0],a=0;l>a&&f(i);a++)i=c(i,o[a],!0);return i},capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},underscore:function(t){return t.replace(n,"/").replace(r,"$1_$2").replace(i,"$1_$2").replace(a,"_").toLowerCase()},sub:function(e,n,r){var i=[];return e=e||"",i.push(e.replace(u,function(e,a){var u=t.getObject(a,n,r===!0?!1:undefined);return u===undefined||null===u?(i=null,""):f(u)&&i?(i.push(u),""):""+u})),null===i?i:1>=i.length?i[0]:i},replacer:u,undHash:e}),t}(__m2),__m8=function(t){var e=0;return t.Construct=function(){return arguments.length?t.Construct.extend.apply(t.Construct,arguments):undefined},t.extend(t.Construct,{constructorExtends:!0,newInstance:function(){var t,e=this.instance();return e.setup&&(t=e.setup.apply(e,arguments)),e.init&&e.init.apply(e,t||arguments),e},_inherit:function(e,n,r){t.extend(r||e,e||{})},_overwrite:function(t,e,n,r){t[n]=r},setup:function(e){this.defaults=t.extend(!0,{},e.defaults,this.defaults)},instance:function(){e=1;var t=new this;return e=0,t},extend:function(n,r,i){function a(){return e?undefined:this.constructor!==a&&arguments.length&&a.constructorExtends?arguments.callee.extend.apply(arguments.callee,arguments):a.newInstance.apply(a,arguments)}"string"!=typeof n&&(i=r,r=n,n=null),i||(i=r,r=null),i=i||{};var u,s,o,c,f=this,l=this.prototype;c=this.instance(),t.Construct._inherit(i,l,c);for(u in f)f.hasOwnProperty(u)&&(a[u]=f[u]);if(t.Construct._inherit(r,f,a),n){var h=n.split("."),s=h.pop(),p=t.getObject(h.join("."),window,!0),o=p,d=t.underscore(n.replace(/\./g,"_")),g=t.underscore(s);p[s]=a}t.extend(a,{constructor:a,prototype:c,namespace:o,_shortName:g,fullName:n,_fullName:d}),s!==undefined&&(a.shortName=s),a.prototype.constructor=a;var m=[f].concat(t.makeArray(arguments)),_=a.setup.apply(a,m);return a.init&&a.init.apply(a,_||m),a}}),t.Construct.prototype.setup=function(){},t.Construct.prototype.init=function(){},t.Construct}(__m9),__m7=function(t){var e,n=function(e,n,r){return t.bind.call(e,n,r),function(){t.unbind.call(e,n,r)}},r=t.isFunction,i=t.extend,a=t.each,u=[].slice,s=/\{([^\}]+)\}/g,o=t.getObject("$.event.special",[t])||{},c=function(e,n,r,i){return t.delegate.call(e,n,r,i),function(){t.undelegate.call(e,n,r,i)}},f=function(e,r,i,a){return a?c(e,t.trim(a),r,i):n(e,r,i)},l=t.Control=t.Construct({setup:function(){if(t.Construct.setup.apply(this,arguments),t.Control){var e,n=this;n.actions={};for(e in n.prototype)n._isAction(e)&&(n.actions[e]=n._action(e))}},_shifter:function(e,n){var i="string"==typeof n?e[n]:n;return r(i)||(i=e[i]),function(){return e.called=n,i.apply(e,[this.nodeName?t.$(this):this].concat(u.call(arguments,0)))}},_isAction:function(t){var e=this.prototype[t],n=typeof e;return"constructor"!==t&&("function"==n||"string"==n&&r(this.prototype[e]))&&!!(o[t]||h[t]||/[^\w]/.test(t))},_action:function(n,r){if(s.lastIndex=0,r||!s.test(n)){var i=r?t.sub(n,this._lookup(r)):n;if(!i)return null;var a=t.isArray(i),u=a?i[1]:i,o=u.split(/\s+/g),c=o.pop();return{processor:h[c]||e,parts:[u,o.join(" "),c],delegate:a?i[0]:undefined}}},_lookup:function(t){return[t,window]},processors:{},defaults:{}},{setup:function(e,n){var r,a=this.constructor,u=a.pluginName||a._fullName;return this.element=t.$(e),u&&"can_control"!==u&&this.element.addClass(u),(r=t.data(this.element,"controls"))||t.data(this.element,"controls",r=[]),r.push(this),this.options=i({},a.defaults,n),this.on(),[this.element,this.options]},on:function(e,n,r,i){if(!e){this.off();var a,u,s=this.constructor,o=this._bindings,c=s.actions,l=this.element,h=t.Control._shifter(this,"destroy");for(a in c)c.hasOwnProperty(a)&&(u=c[a]||s._action(a,this.options))&&o.push(u.processor(u.delegate||l,u.parts[2],u.parts[1],a,this));return t.bind.call(l,"removed",h),o.push(function(e){t.unbind.call(e,"removed",h)}),o.length}return"string"==typeof e&&(i=r,r=n,n=e,e=this.element),i===undefined&&(i=r,r=n,n=null),"string"==typeof i&&(i=t.Control._shifter(this,i)),this._bindings.push(f(e,r,i,n)),this._bindings.length},off:function(){var t=this.element[0];a(this._bindings||[],function(e){e(t)}),this._bindings=[]},destroy:function(){if(null!==this.element){var e,n=this.constructor,r=n.pluginName||n._fullName;this.off(),r&&"can_control"!==r&&this.element.removeClass(r),e=t.data(this.element,"controls"),e.splice(t.inArray(this,e),1),t.trigger(this,"destroyed"),this.element=null}}}),h=t.Control.processors,e=function(e,n,r,i,a){return f(e,n,t.Control._shifter(a,i),r)};return a(["change","click","contextmenu","dblclick","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","reset","resize","scroll","select","submit","focusin","focusout","mouseenter","mouseleave","touchstart","touchmove","touchcancel","touchend","touchleave"],function(t){h[t]=e}),l}(__m2,__m8),__m12=function(t){return t.bindAndSetup=function(){return t.addEvent.apply(this,arguments),this._init||(this._bindings?this._bindings++:(this._bindings=1,this._bindsetup&&this._bindsetup())),this},t.unbindAndTeardown=function(){return t.removeEvent.apply(this,arguments),null==this._bindings?this._bindings=0:this._bindings--,this._bindings||this._bindteardown&&this._bindteardown(),this},t}(__m2),__m13=function(t){var e=1,n=0,r=[],i=[];t.batch={start:function(t){n++,t&&i.push(t)},stop:function(a,u){if(a?n=0:n--,0==n){var s=r.slice(0),o=i.slice(0);r=[],i=[],e++,u&&t.batch.start(),t.each(s,function(e){t.trigger.apply(t,e)}),t.each(o,function(t){t()})}},trigger:function(i,a,u){if(!i._init){if(0==n)return t.trigger(i,a,u);a="string"==typeof a?{type:a}:a,a.batchNum=e,r.push([i,a,u])}}}}(__m4),__m11=function(t){var e=function(e,n,r){e.bind("change"+r._cid,function(){var i=t.makeArray(arguments),a=i.shift();i[0]=("*"===n?[r.indexOf(e),i[0]]:[n,i[0]]).join("."),a.triggeredNS=a.triggeredNS||{},a.triggeredNS[r._cid]||(a.triggeredNS[r._cid]=!0,t.trigger(r,a,i))})},n=function(e,n){return n?[e]:t.isArray(e)?e:(""+e).split(".")},r=function(t){return function(){var n=this;this._each(function(r,i){r&&r.bind&&e(r,t||i,n)})}},i=t.Map=t.Construct.extend({setup:function(){if(t.Construct.setup.apply(this,arguments),t.Map){this.defaults||(this.defaults={});for(var e in this.prototype)"function"!=typeof this.prototype[e]&&(this.defaults[e]=this.prototype[e])}!t.List||this.prototype instanceof t.List||(this.List=i.List({Map:this},{}))},bind:t.bindAndSetup,on:t.bindAndSetup,unbind:t.unbindAndTeardown,off:t.unbindAndTeardown,id:"id",helpers:{canMakeObserve:function(e){return e&&!t.isDeferred(e)&&(t.isArray(e)||t.isPlainObject(e)||e instanceof t.Map)},unhookup:function(e,n){return t.each(e,function(t){t&&t.unbind&&t.unbind("change"+n)})},hookupBubble:function(n,r,a,u,s){return u=u||i,s=s||i.List,n instanceof i?a._bindings&&i.helpers.unhookup([n],a._cid):n=t.isArray(n)?new s(n):new u(n),a._bindings&&e(n,r,a),n},serialize:function(e,n,r){return e.each(function(e,a){r[a]=i.helpers.canMakeObserve(e)&&t.isFunction(e[n])?e[n]():e}),r},makeBindSetup:r},keys:function(e){var n=[];t.__reading&&t.__reading(e,"__keys");for(var r in e._data)n.push(r);return n}},{setup:function(e){this._data={},t.cid(this,".map"),this._init=1,this._setupComputes();var n=t.extend(t.extend(!0,{},this.constructor.defaults||{}),e);this.attr(n),this.bind("change"+this._cid,t.proxy(this._changes,this)),delete this._init},_setupComputes:function(){var t=this.constructor.prototype;for(var e in t)t[e]&&t[e].isComputed&&(this[e]=t[e].clone(this))},_bindsetup:r(),_bindteardown:function(){var t=this._cid;this._each(function(e){i.helpers.unhookup([e],t)})},_changes:function(e,n,r,i,a){t.batch.trigger(this,{type:n,batchNum:e.batchNum},[i,a])},_triggerChange:function(){t.batch.trigger(this,"change",t.makeArray(arguments))},_each:function(t){var e=this.__get();for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},attr:function(e,n){var r=typeof e;return"string"!==r&&"number"!==r?this._attrs(e,n):1===arguments.length?(t.__reading&&t.__reading(this,e),this._get(e)):(this._set(e,n),this)},each:function(){return t.__reading&&t.__reading(this,"__keys"),t.each.apply(undefined,[this.__get()].concat(t.makeArray(arguments)))},removeAttr:function(e){var r=t.List&&this instanceof t.List,i=n(e),a=i.shift(),u=r?this[a]:this._data[a];return i.length?u.removeAttr(i):(r?this.splice(a,1):a in this._data&&(delete this._data[a],a in this.constructor.prototype||delete this[a],t.batch.trigger(this,"__keys"),this._triggerChange(a,"remove",undefined,u)),u)},_get:function(t){var e="string"==typeof t&&!!~t.indexOf(".")&&this.__get(t);if(e)return e;var r=n(t),i=this.__get(r.shift());return r.length?i?i._get(r):undefined:i},__get:function(t){return t?this[t]&&this[t].isComputed?this[t]():this._data[t]:this._data},_set:function(t,e,r){var a=n(t,r),u=a.shift(),s=this.__get(u);if(i.helpers.canMakeObserve(s)&&a.length)s._set(a,e);else{if(a.length)throw"can.Map: Object does not exist";this.__convert&&(e=this.__convert(u,e)),this.__set(u,e,s)}},__set:function(e,n,r){if(n!==r){var a=this.__get().hasOwnProperty(e)?"set":"add";this.___set(e,i.helpers.canMakeObserve(n)?i.helpers.hookupBubble(n,e,this):n),"add"==a&&t.batch.trigger(this,"__keys",undefined),this._triggerChange(e,a,n,r),r&&i.helpers.unhookup([r],this._cid)}},___set:function(e,n){this[e]&&this[e].isComputed&&this[e](n),this._data[e]=n,t.isFunction(this.constructor.prototype[e])||(this[e]=n)},bind:t.bindAndSetup,on:t.bindAndSetup,unbind:t.unbindAndTeardown,off:t.unbindAndTeardown,serialize:function(){return t.Map.helpers.serialize(this,"serialize",{})},_attrs:function(e,n){if(e===undefined)return i.helpers.serialize(this,"attr",{});e=t.extend({},e);var r,a,u=this;t.batch.start(),this.each(function(r,s){return a=e[s],a===undefined?(n&&u.removeAttr(s),undefined):(u.__convert&&(a=u.__convert(s,a)),a instanceof t.Map?u.__set(s,a,r):i.helpers.canMakeObserve(r)&&i.helpers.canMakeObserve(a)&&r.attr?r.attr(a,n):r!=a&&u.__set(s,a,r),delete e[s],undefined)});for(var r in e)a=e[r],this._set(r,a,!0);return t.batch.stop(),this},compute:function(e){return t.isFunction(this.constructor.prototype[e])?t.compute(this[e],this):t.compute(this,e)}});return i}(__m2,__m12,__m8,__m13),__m14=function(t,e){var n=[].splice,r=e({setup:function(e,n){this.length=0,t.cid(this,".map"),this._init=1,t.isDeferred(e)?this.replace(e):this.push.apply(this,t.makeArray(e||[])),this.bind("change"+this._cid,t.proxy(this._changes,this)),t.extend(this,n),delete this._init},_triggerChange:function(n,r,i,a){e.prototype._triggerChange.apply(this,arguments),~n.indexOf(".")||("add"===r?(t.batch.trigger(this,r,[i,+n]),t.batch.trigger(this,"length",[this.length])):"remove"===r?(t.batch.trigger(this,r,[a,+n]),t.batch.trigger(this,"length",[this.length])):t.batch.trigger(this,r,[i,+n]))},__get:function(t){return t?this[t]:this},___set:function(t,e){this[t]=e,+t>=this.length&&(this.length=+t+1)},_each:function(t){for(var e=this.__get(),n=0;e.length>n;n++)t(e[n],n)},_bindsetup:e.helpers.makeBindSetup("*"),serialize:function(){return e.helpers.serialize(this,"serialize",[])},splice:function(r,i){var a,u=t.makeArray(arguments);for(a=2;u.length>a;a++){var s=u[a];e.helpers.canMakeObserve(s)&&(u[a]=e.helpers.hookupBubble(s,"*",this,this.constructor.Map,this.constructor))}i===undefined&&(i=u[1]=this.length-r);var o=n.apply(this,u);return t.batch.start(),i>0&&(this._triggerChange(""+r,"remove",undefined,o),e.helpers.unhookup(o,this._cid)),u.length>2&&this._triggerChange(""+r,"add",u.slice(2),o),t.batch.stop(),o},_attrs:function(n,r){return n===undefined?e.helpers.serialize(this,"attr",[]):(n=t.makeArray(n),t.batch.start(),this._updateAttrs(n,r),t.batch.stop(),undefined)},_updateAttrs:function(t,n){for(var r=Math.min(t.length,this.length),i=0;r>i;i++){var a=this[i],u=t[i];e.helpers.canMakeObserve(a)&&e.helpers.canMakeObserve(u)?a.attr(u,n):a!=u&&this._set(i,u)}t.length>this.length?this.push.apply(this,t.slice(this.length)):t.length<this.length&&n&&this.splice(t.length)}}),i=function(e){return e[0]&&t.isArray(e[0])?e[0]:t.makeArray(e)};return t.each({push:"length",unshift:0},function(t,n){var i=[][n];r.prototype[n]=function(){var n,r,a=[],u=t?this.length:0,s=arguments.length;for(this.constructor;s--;)r=arguments[s],a[s]=e.helpers.canMakeObserve(r)?e.helpers.hookupBubble(r,"*",this,this.constructor.Map,this.constructor):r;return n=i.apply(this,a),(!this.comparator||a.length)&&this._triggerChange(""+u,"add",a,undefined),n}}),t.each({pop:"length",shift:0},function(t,e){r.prototype[e]=function(){var n=i(arguments),r=t&&this.length?this.length-1:0,a=[][e].apply(this,n);return this._triggerChange(""+r,"remove",undefined,[a]),a&&a.unbind&&a.unbind("change"+this._cid),a}}),t.extend(r.prototype,{indexOf:function(e){return this.attr("length"),t.inArray(e,this)},join:[].join,reverse:[].reverse,slice:function(){var t=Array.prototype.slice.apply(this,arguments);return new this.constructor(t)},concat:function(){var e=[];return t.each(t.makeArray(arguments),function(n,r){e[r]=n instanceof t.List?n.serialize():n}),new this.constructor(Array.prototype.concat.apply(this.serialize(),e))},forEach:function(e,n){t.each(this,e,n||this)},replace:function(e){return t.isDeferred(e)?e.then(t.proxy(this.replace,this)):this.splice.apply(this,[0,this.length].concat(t.makeArray(e||[]))),this}}),t.List=e.List=r,t.List}(__m2,__m11),__m15=function(t){var e=function(e,n){var r;r=t.__reading,t.__reading=function(t,e){i.push({obj:t,attr:e+""})};var i=[],a=e.call(n);return t.__reading=r,{value:a,observed:i}},n=function(n,r,i,a){var u,s={},o=!0,c={value:undefined,teardown:function(){for(var t in s){var e=s[t];e.observe.obj.unbind(e.observe.attr,f),delete s[t]}}},f=function(t){if(!(a&&!a.bound||t.batchNum!==undefined&&t.batchNum===u)){var e=c.value,n=l();c.value=n,n!==e&&i(n,e),u=u=t.batchNum}},l=function(){var i=e(n,r),a=i.observed,u=i.value;o=!o,t.each(a,function(t){s[t.obj._cid+"|"+t.attr]?s[t.obj._cid+"|"+t.attr].matched=o:(s[t.obj._cid+"|"+t.attr]={matched:o,observe:t},t.obj.bind(t.attr,f))});for(var c in s){var l=s[c];l.matched!==o&&(l.observe.obj.unbind(l.observe.attr,f),delete s[c])}return u};return c.value=l(),c.isListening=!t.isEmptyObject(s),c};return t.compute=function(r,i,a){if(r&&r.isComputed)return r;var u,s,o,c={bound:!1,hasDependencies:!1},f=function(){},l=function(){},h=function(){return o},p=function(t){o=t},d=!0,g=t.makeArray(arguments);if(s=function(e){if(arguments.length){var n=o,r=p.call(i,e,n);return s.hasDependencies?h.call(i):(o=r===undefined?h.call(i):r,n!==o&&t.batch.trigger(s,"change",[o,n]),o)}var a,u=t.__reading;return t.__reading&&d&&(t.__reading(s,"change"),delete t.__reading),a=c.bound?o:h.call(i),t.__reading=u,a},"function"==typeof r)p=r,h=r,d=a===!1?!1:!0,s.hasDependencies=!1,f=function(t){u=n(r,i||this,t,c),s.hasDependencies=u.isListening,o=u.value},l=function(){u&&u.teardown()};else if(i)if("string"==typeof i){var m=i,_=r instanceof t.Map;_&&(s.hasDependencies=!0),h=function(){return _?r.attr(m):r[m]},p=function(t){_?r.attr(m,t):r[m]=t};var v;f=function(n){v=function(){n(h(),o)},t.bind.call(r,a||m,v),o=e(h).value},l=function(){t.unbind.call(r,a||m,v)}}else if("function"==typeof i)o=r,p=i;else{o=r;var b=i;h=b.get||h,p=b.set||p,f=b.on||f,l=b.off||l}else o=r;s.isComputed=!0,t.cid(s,"compute");var y=function(e,n){o=e,t.batch.trigger(s,"change",[e,n])};return t.extend(s,{_bindsetup:function(){c.bound=!0,f.call(this,y)},_bindteardown:function(){l.call(this,y),c.bound=!1},bind:t.bindAndSetup,unbind:t.unbindAndTeardown,clone:function(e){return e&&(g[1]=e),t.compute.apply(t,g)}})},t.compute.binder=n,t.compute}(__m2,__m12,__m13),__m10=function(t){return t.Observe=t.Map,t.Observe.startBatch=t.batch.start,t.Observe.stopBatch=t.batch.stop,t.Observe.triggerBatch=t.batch.trigger,t}(__m2,__m11,__m14,__m15),__m18=function(t){var e=t.isFunction,n=t.makeArray,r=1,i=t.view=t.template=function(n,r,a,u){e(a)&&(u=a,a=undefined);var s=function(t){return i.frag(t)},o=e(u)?function(t){u(s(t))}:null,c=e(n)?n(r,a,o):i.render(n,r,a,o),f=t.Deferred();return e(c)?c:t.isDeferred(c)?(c.then(function(t,e){f.resolve.call(f,s(t),e)},function(){f.fail.apply(f,arguments)}),f):s(c)};t.extend(i,{frag:function(t,e){return i.hookup(i.fragment(t),e)},fragment:function(e){var n=t.buildFragment(e,document.body);return n.childNodes.length||n.appendChild(document.createTextNode("")),n},toId:function(e){return t.map((""+e).split(/\/|\./g),function(t){return t?t:undefined}).join("_")},hookup:function(e,n){var r,a,u=[];return t.each(e.childNodes?t.makeArray(e.childNodes):e,function(e){1===e.nodeType&&(u.push(e),u.push.apply(u,t.makeArray(e.getElementsByTagName("*"))))}),t.each(u,function(t){t.getAttribute&&(r=t.getAttribute("data-view-id"))&&(a=i.hookups[r])&&(a(t,n,r),delete i.hookups[r],t.removeAttribute("data-view-id"))}),e},hookups:{},hook:function(t){return i.hookups[++r]=t," data-view-id='"+r+"'"},cached:{},cachedRenderers:{},cache:!0,register:function(t){this.types["."+t.suffix]=t},types:{},ext:".ejs",registerScript:function(){},preload:function(){},render:function(r,a,c,f){e(c)&&(f=c,c=undefined);var l=s(a);if(l.length){var h=new t.Deferred,p=t.extend({},a);return l.push(u(r,!0)),t.when.apply(t,l).then(function(e){var r,i=n(arguments),u=i.pop();if(t.isDeferred(a))p=o(e);else for(var s in a)t.isDeferred(a[s])&&(p[s]=o(i.shift()));r=u(p,c),h.resolve(r,p),f&&f(r,p)},function(){h.reject.apply(h,arguments)}),h}if(t.__reading){var d=t.__reading;t.__reading=null}var g,m=e(f),h=u(r,m);if(t.Map&&t.__reading&&(t.__reading=d),m)g=h,h.then(function(t){f(a?t(a,c):t)});else{if("resolved"===h.state()&&h.__view_id){var _=i.cachedRenderers[h.__view_id];return a?_(a,c):_}h.then(function(t){g=a?t(a,c):t})}return g},registerView:function(e,n,r,a){var u=(r||i.types[i.ext]).renderer(e,n);return a=a||new t.Deferred,i.cache&&(i.cached[e]=a,a.__view_id=e,i.cachedRenderers[e]=u),a.resolve(u)}});var a=function(t,e){if(!t.length)throw"can.view: No template or empty template:"+e},u=function(e,n){var r,u,s,o="string"==typeof e?e:e.url,c=e.engine||o.match(/\.[\w\d]+$/);if(o.match(/^#/)&&(o=o.substr(1)),(u=document.getElementById(o))&&(c="."+u.type.match(/\/(x\-)?(.+)/)[2]),c||i.cached[o]||(o+=c=i.ext),t.isArray(c)&&(c=c[0]),s=i.toId(o),o.match(/^\/\//)){var f=o.substr(2);o=window.steal?steal.config().root.mapJoin(""+steal.id(f)):f}if(r=i.types[c],i.cached[s])return i.cached[s];if(u)return i.registerView(s,u.innerHTML,r);var l=new t.Deferred;return t.ajax({async:n,url:o,dataType:"text",error:function(t){a("",o),l.reject(t)},success:function(t){a(t,o),i.registerView(s,t,r,l)}}),l},s=function(e){var n=[];if(t.isDeferred(e))return[e];for(var r in e)t.isDeferred(e[r])&&n.push(e[r]);return n},o=function(e){return t.isArray(e)&&"success"===e[1]?e[0]:e};return window.steal&&steal.type("view js",function(t,e){var n=i.types["."+t.type],r=i.toId(t.id);t.text="steal('"+(n.plugin||"can/view/"+t.type)+"',function(can){return "+"can.view.preload('"+r+"',"+t.text+");\n})",e()}),t.extend(i,{register:function(t){this.types["."+t.suffix]=t,window.steal&&steal.type(t.suffix+" view js",function(t,e){var n=i.types["."+t.type],r=i.toId(t.id+"");t.text=n.script(r,t.text),e()}),i[t.suffix]=function(e,n){if(!n){var r=function(){return i.frag(r.render.apply(this,arguments))};return r.render=function(){var n=t.renderer(null,e);return n.apply(n,arguments)},r}return i.preload(e,t.renderer(e,n))}},registerScript:function(t,e,n){return"can.view.preload('"+e+"',"+i.types["."+t].script(e,n)+");"},preload:function(e,n){function r(){return i.frag(n.apply(this,arguments))}var a=i.cached[e]=(new t.Deferred).resolve(function(t,e){return n.call(t,t,e)});return r.render=n,a.__view_id=e,i.cachedRenderers[e]=n,r}}),t}(__m2),__m17=function(t){var e=function(e){return e instanceof t.Map||e&&!!e.__get},n=function(t,e){var n=t[e];return"function"!=typeof n&&t.__get?t.__get(e):n},r=t.Construct.extend({init:function(t,e){this._data=t,this._parent=e},get:function(r){if("../"===r.substr(0,3))return this._parent.get(r.substr(3));if(".."==r)return{value:this._parent._data};if("."==r||"this"==r)return{value:this._data};for(var i,a,u,s,o,c=-1==r.indexOf("\\.")?r.split("."):function(){var t=[],e=0;return r.replace(/(\\)?\./g,function(n,i,a){i||(t.push(r.slice(e,a).replace(/\\\./g,".")),e=a+n.length)}),t.push(r.slice(e).replace(/\\\./g,".")),t}(),f=c.length,l=-1,h=this;h;){if(o=h._data,null!=o)for(u=0;f>u;u++){t.isFunction(o)&&o.isComputed&&(o=o());var p=n(o,c[u]);if(p===undefined||null===p){if(e(o)&&u>l){i=o,a=c[u],l=u,s=o=undefined;break}s=o=undefined;break}s=o,o=p,name=c[u]}if(o!==undefined)return{scope:h,parent:s||h._data,value:o,name:name};h=h._parent}return i?{parent:i,name:a,value:undefined}:{parent:null,name:r,value:undefined}},attr:function(t,e){return arguments.length>1?(this._data.attr(t,e),this):this.get(t).value},add:function(t){return t!==this._data?new this.constructor(t,this):this},compute:function(n){var r=this.get(n);return e(r.parent)?r.parent.compute(r.name):(t.compute(function(t){return arguments.length?(r.parent[r.name]=t,undefined):r.parent[r.name]}),undefined)}});return t.view.Scope=r,r}(__m2,__m8,__m11,__m14,__m18,__m15),__m20=function(){var t={tagToContentPropMap:{option:"textContent"in document.createElement("option")?"textContent":"innerText",textarea:"value"},attrMap:{"class":"className",value:"value",innerText:"innerText",textContent:"textContent",checked:!0,disabled:!0,readonly:!0,required:!0,src:function(t,e){null==e||""==e?t.removeAttribute("src"):t.setAttribute("src",e)}},attrReg:/([^\s]+)[\s]*=[\s]*/,defaultValue:["input","textarea"],tagMap:{"":"span",table:"tbody",tr:"td",ol:"li",ul:"li",tbody:"tr",thead:"tr",tfoot:"tr",select:"option",optgroup:"option"},reverseTagMap:{tr:"tbody",option:"select",td:"tr",th:"tr",li:"ul"},getParentNode:function(t,e){return e&&11===t.parentNode.nodeType?e:t.parentNode},setAttr:function(e,n,r){var i=(""+e.nodeName).toLowerCase(),a=t.attrMap[n];"function"==typeof a?a(e,r):a===!0?e[n]=!0:a?(e[a]=r,"value"===a&&can.inArray(i,t.defaultValue)>=0&&(e.defaultValue=r)):e.setAttribute(n,r)},getAttr:function(e,n){return(t.attrMap[n]&&e[t.attrMap[n]]?e[t.attrMap[n]]:e.getAttribute(n))||""},removeAttr:function(e,n){var r=t.attrMap[n];"function"==typeof prop&&prop(e,undefined),r===!0?e[n]=!1:"string"==typeof r?e[r]="":e.removeAttribute(n)},contentText:function(t){return"string"==typeof t?t:t||0===t?""+t:""}};return function(){var e=document.createElement("div");e.setAttribute("style","width: 5px"),e.setAttribute("style","width: 10px"),t.attrMap.style=function(t,e){t.style.cssText=e||""}}(),t}(),__m19=function(can,elements){var newLine=/(\r|\n)+/g,clean=function(t){return t.split("\\").join("\\\\").split("\n").join("\\n").split('"').join('\\"').split("	").join("\\t")},getTag=function(t,e,n){if(t)return t;for(;e.length>n;){if("<"==e[n]&&elements.reverseTagMap[e[n+1]])return elements.reverseTagMap[e[n+1]];n++}return""},bracketNum=function(t){return--t.split("{").length- --t.split("}").length},myEval=function(script){eval(script)},attrReg=/([^\s]+)[\s]*=[\s]*$/,startTxt="var ___v1ew = [];",finishTxt="return ___v1ew.join('')",put_cmd="___v1ew.push(\n",insert_cmd=put_cmd,htmlTag=null,quote=null,beforeQuote=null,rescan=null,getAttrName=function(){var t=beforeQuote.match(attrReg);return t&&t[1]},status=function(){return quote?"'"+getAttrName()+"'":htmlTag?1:0},top=function(t){return t[t.length-1]};return can.view.Scanner=Scanner=function(t){can.extend(this,{text:{},tokens:[]},t),this.text.options=this.text.options||"",this.tokenReg=[],this.tokenSimple={"<":"<",">":">",'"':'"',"'":"'"},this.tokenComplex=[],this.tokenMap={};for(var e,n=0;e=this.tokens[n];n++)e[2]?(this.tokenReg.push(e[2]),this.tokenComplex.push({abbr:e[1],re:RegExp(e[2]),rescan:e[3]})):(this.tokenReg.push(e[1]),this.tokenSimple[e[1]]=e[0]),this.tokenMap[e[0]]=e[1];this.tokenReg=RegExp("("+this.tokenReg.slice(0).concat(["<",">",'"',"'"]).join("|")+")","g")},Scanner.attributes={},Scanner.regExpAttributes={},Scanner.attribute=function(t,e){"string"==typeof t?Scanner.attributes[t]=e:Scanner.regExpAttributes[t]={match:t,callback:e}},Scanner.hookupAttributes=function(t,e){can.each(t&&t.attrs||[],function(n){t.attr=n,Scanner.attributes[n]?Scanner.attributes[n](t,e):can.each(Scanner.regExpAttributes,function(r){r.match.test(n)&&r.callback(t,e)})})},Scanner.tag=function(t,e){window.html5&&(html5.elements+=" "+t,html5.shivDocument()),Scanner.tags[t.toLowerCase()]=e},Scanner.tags={},Scanner.hookupTag=function(t){var e=can.view.getHooks();return can.view.hook(function(n){can.each(e,function(t){t(n)});var r=t.options.attr("helpers._tags"),i=t.tagName,a=r&&r[i]||Scanner.tags[i],u=a(n,t),s=t.scope;if(u){s!==u&&(s=s.add(u));var o=can.view.frag(t.subtemplate(s,t.options));can.appendChild(n,o)}can.view.Scanner.hookupAttributes(t,n)})},Scanner.prototype={helpers:[],scan:function(t,e){var n=[],r=0,i=this.tokenSimple,a=this.tokenComplex;t=t.replace(newLine,"\n"),this.transform&&(t=this.transform(t)),t.replace(this.tokenReg,function(e,u){var s=arguments[arguments.length-2];if(s>r&&n.push(t.substring(r,s)),i[e])n.push(e);else for(var o,c=0;o=a[c];c++)if(o.re.test(e)){n.push(o.abbr),o.rescan&&n.push(o.rescan(u));break}r=s+u.length}),t.length>r&&n.push(t.substr(r));var u,s,o,c,f="",l=[startTxt+(this.text.start||"")],h=function(t,e){l.push(put_cmd,'"',clean(t),'"'+(e||"")+");")},p=[],d=null,g=!1,m={attributeHookups:[],tagHookups:[]},_="",v=[],b=!1,y=!1,x=0,w=this.tokenMap;for(htmlTag=quote=beforeQuote=null;(o=n[x++])!==undefined;){if(null===d)switch(o){case w.left:case w.escapeLeft:case w.returnLeft:g=htmlTag&&1;case w.commentLeft:d=o,f.length&&h(f),f="";break;case w.escapeFull:g=htmlTag&&1,rescan=1,d=w.escapeLeft,f.length&&h(f),rescan=n[x++],f=rescan.content||rescan,rescan.before&&h(rescan.before),n.splice(x,0,w.right);break;case w.commentFull:break;case w.templateLeft:f+=w.left;break;case"<":0!==n[x].indexOf("!--")&&(htmlTag=1,g=0),f+=o;break;case">":htmlTag=0;var k="/"==f.substr(f.length-1)||"--"==f.substr(f.length-2),M="";m.attributeHookups.length&&(M="attrs: ['"+m.attributeHookups.join("','")+"'], ",m.attributeHookups=[]),_===top(m.tagHookups)?(k&&(f=f.substr(0,f.length-1)),l.push(put_cmd,'"',clean(f),'"',",can.view.Scanner.hookupTag({tagName:'"+_+"',"+M+"scope: "+(this.text.scope||"this")+this.text.options),k?(l.push("}));"),f="/>",m.tagHookups.pop()):"<"===n[x]&&n[x+1]==="/"+_?(l.push("}));"),f=o,m.tagHookups.pop()):(l.push(",subtemplate: function("+this.text.argNames+"){\n"+startTxt+(this.text.start||"")),f="")):g||!b&&elements.tagToContentPropMap[v[v.length-1]]||M?(k?h(f.substr(0,f.length-1),",can.view.pending({"+M+"scope: "+(this.text.scope||"this")+this.text.options+'}),"/>"'):h(f,",can.view.pending({"+M+"scope: "+(this.text.scope||"this")+this.text.options+'}),">"'),f="",g=0):f+=o,(k||b)&&(v.pop(),_=v[v.length-1],b=!1),m.attributeHookups=[];break;case"'":case'"':if(htmlTag)if(quote&&quote===o){quote=null;var A=getAttrName();if(Scanner.attributes[A]?m.attributeHookups.push(A):can.each(Scanner.regExpAttributes,function(t){t.match.test(A)&&m.attributeHookups.push(A)}),y){f+=o,h(f),l.push(finishTxt,"}));\n"),f="",y=!1;break}}else if(null===quote&&(quote=o,beforeQuote=u,c=getAttrName(),"img"==_&&"src"==c||"style"===c)){h(f.replace(attrReg,"")),f="",y=!0,l.push(insert_cmd,"can.view.txt(2,'"+getTag(_,n,x)+"',"+status()+",this,function(){",startTxt),h(c+"="+o);break}default:if("<"===u){_=o.split(/\s/)[0];var C=!1;if(0===_.indexOf("/")){C=!0;var N=_.substr(1)}C?(top(v)===N&&(_=N,b=!0),top(m.tagHookups)==N&&(h(f.substr(0,f.length-1)),l.push(finishTxt+"}}) );"),f="><",m.tagHookups.pop())):(_.lastIndexOf("/")===_.length-1&&(_=_.substr(0,_.length-1)),Scanner.tags[_]&&("content"===_&&elements.tagMap[top(v)]&&(o=o.replace("content",elements.tagMap[top(v)])),m.tagHookups.push(_)),v.push(_))}f+=o}else switch(o){case w.right:case w.returnRight:switch(d){case w.left:s=bracketNum(f),1==s?(l.push(insert_cmd,"can.view.txt(0,'"+getTag(_,n,x)+"',"+status()+",this,function(){",startTxt,f),p.push({before:"",after:finishTxt+"}));\n"})):(r=p.length&&-1==s?p.pop():{after:";"},r.before&&l.push(r.before),l.push(f,";",r.after));break;case w.escapeLeft:case w.returnLeft:s=bracketNum(f),s&&p.push({before:finishTxt,after:"}));\n"});for(var T=d===w.escapeLeft?1:0,j={insert:insert_cmd,tagName:getTag(_,n,x),status:status(),specialAttribute:y},S=0;this.helpers.length>S;S++){var O=this.helpers[S];if(O.name.test(f)){f=O.fn(f,j),O.name.source==/^>[\s]*\w*/.source&&(T=0);break}}"object"==typeof f?f.raw&&l.push(f.raw):y?l.push(insert_cmd,f,");"):l.push(insert_cmd,"can.view.txt(\n"+T+",\n'"+_+"',\n"+status()+",\nthis,\nfunction(){ "+(this.text.escape||"")+"return ",f,s?startTxt:"}));\n"),rescan&&rescan.after&&rescan.after.length&&(h(rescan.after.length),rescan=null)}d=null,f="";break;case w.templateLeft:f+=w.left;break;default:f+=o}u=o}f.length&&h(f),l.push(";");var L=l.join(""),E={out:(this.text.outStart||"")+L+" "+finishTxt+(this.text.outEnd||"")};return myEval.call(E,"this.fn = (function("+this.text.argNames+"){"+E.out+"});\r\n//@ sourceURL="+e+".js"),E
}},can.view.Scanner.tag("content",function(t,e){return e.scope}),Scanner}(__m18,__m20),__m23=function(t){var e=!0;try{document.createTextNode("")._=0}catch(n){e=!1}var r={},i={},a={},u="ejs_"+Math.random(),s=0,o=function(t){if(e||3!==t.nodeType)return t[u]?t[u]:t[u]=(t.nodeName?"element_":"obj_")+ ++s;for(var n in i)if(i[n]===t)return n;return i["text_"+ ++s]=t,"text_"+s},c=function(e,n){var i=r[o(e)];if(i){var a=t.inArray(n,i);a>=0&&i.splice(a,1),i.length||delete r[o(e)]}},f=function(t,e){var n=r[o(t)];n||(n=r[o(t)]=[]),n.push(e)},l={id:o,replace:function(e,n){e=t.makeArray(e);var i=e[0];t.each(t.makeArray(r[o(i)]),function(r){var u=a[r],s=t.inArray(i,u),o=t.inArray(e[e.length-1],u);if(s>=0&&o>=0){for(var h=s;o>=h;h++){var p=u[h];c(p,r)}u.splice.apply(u,[s,o-s+1].concat(n)),t.each(n,function(t){f(t,r)})}else l.unregister(u)})},register:function(e){var n=o(e);a[n]=e,t.each(e,function(t){f(t,n)})},unregister:function(e){var n=o(e);t.each(e,function(t){c(t,n)}),delete a[n]},nodeMap:r,nodeListMap:a};return l}(__m2),__m22=function(t,e,n,r){var i=function(e,n,r){var i=function(){r(a),t.unbind.call(e,"removed",i)},a={teardownCheck:function(t){t||i()}};return t.bind.call(e,"removed",i),n(a),a},a=function(t,e,n){return i(t,function(){e.bind("change",n)},function(t){e.unbind("change",n),t.nodeList&&r.unregister(t.nodeList)})},u=function(t){return(t||"").replace(/['"]/g,"").split("=")};insertElementsAfter=function(e,n){var r=e[e.length-1];r.nextSibling?t.insertBefore(r.parentNode,n,r.nextSibling):t.appendChild(r.parentNode,n)};var s={nodeLists:r,list:function(n,a,u,s,o){var c=[],f=function(e,n,i){var a=document.createDocumentFragment(),f=[];if(t.each(n,function(e){var n=u.call(s,e),r=t.view.frag(n,o);f.push(t.makeArray(r.childNodes)),a.appendChild(r)}),c[i]){var l=c[i][0];t.insertBefore(l.parentNode,a,l)}else insertElementsAfter(0==i?[h]:c[i-1],a);t.each(f,function(t){r.register(t)}),[].splice.apply(c,[i,0].concat(f))},l=function(e,n,i){var a=c.splice(i,n.length),u=[];t.each(a,function(t){[].push.apply(u,t),r.replace(t,[]),r.unregister(t)}),t.remove(t.$(u))},o=e.getParentNode(n,o),h=document.createTextNode("");i(o,function(){a.bind("add",f).bind("remove",l)},function(){a.unbind("add",f).unbind("remove",l),t.each(c,function(t){r.unregister(t)})}),insertElementsAfter([n],h),t.remove(t.$(n)),f({},a,0)},html:function(n,i,u){var s,u=e.getParentNode(n,u),o=a(u,i,function(t,e){var n=s[0].parentNode;n&&c(e),o.teardownCheck(s[0].parentNode)}),c=function(e){var i=t.view.frag(e,u),a=t.makeArray(i.childNodes);if(insertElementsAfter(s||[n],i),s){var c=t.makeArray(s);r.replace(s,a),t.remove(t.$(c))}else t.remove(t.$(n)),s=a,o.nodeList=s,r.register(s)};c(i(),[n])},text:function(t,n,r){var i=e.getParentNode(t,r),u=a(t.parentNode!==i?t.parentNode:i,n,function(t,e){"unknown"!=typeof s.nodeValue&&(s.nodeValue=""+e),u.teardownCheck(s.parentNode)}),s=document.createTextNode(n());t.parentNode!==i?(i=t.parentNode,i.insertBefore(s,t),i.removeChild(t)):(i.insertBefore(s,t),i.removeChild(t))},attributes:function(t,n,r){var i=function(n){var r=u(n),i=r.shift();i!=s&&s&&e.removeAttr(t,s),i&&(e.setAttr(t,i,r.join("=")),s=i)};if(a(t,n,function(t,e){i(e)}),arguments.length>=3)var s=u(r)[0];else i(n())},attributePlaceholder:"__!!__",attributeReplace:/__!!__/g,attribute:function(n,r,i){a(n,i,function(){e.setAttr(n,r,c.render())});var u,o=t.$(n);u=t.data(o,"hooks"),u||t.data(o,"hooks",u={});var c,f=e.getAttr(n,r),l=f.split(s.attributePlaceholder),h=[];h.push(l.shift(),l.join(s.attributePlaceholder)),u[r]?u[r].computes.push(i):u[r]={render:function(){var t=0,n=f?f.replace(s.attributeReplace,function(){return e.contentText(c.computes[t++]())}):e.contentText(c.computes[t++]());return n},computes:[i],batchNum:undefined},c=u[r],h.splice(1,0,i()),e.setAttr(n,r,h.join(""))},specialAttribute:function(t,n,r){a(t,r,function(r,i){e.setAttr(t,n,o(i))}),e.setAttr(t,n,o(r()))}},o=function(t){return t=t.replace(e.attrReg,""),/^["'].*["']$/.test(t)?t.substr(1,t.length-2):t};return s}(__m2,__m20,__m18,__m23),__m21=function(t,e,n){var r=[],i=function(t){var n=e.tagMap[t]||"span";return"span"===n?"@@!!@@":"<"+n+">"+i(n)+"</"+n+">"},a=function(e,n){if("string"==typeof e)return e;if(!e&&0!==e)return"";var i=e.hookup&&function(t,n){e.hookup.call(e,t,n)}||"function"==typeof e&&e;return i?n?"<"+n+" "+t.view.hook(i)+"></"+n+">":(r.push(i),""):""+e},u=function(e,n){return"string"==typeof e||"number"==typeof e?t.esc(e):a(e,n)};return t.extend(t.view,{live:n,setupLists:function(){var e,n=t.view.lists;return t.view.lists=function(t,n){e={list:t,renderer:n}},function(){return t.view.lists=n,e}},pending:function(e){var n=t.view.getHooks();return t.view.hook(function(r){t.each(n,function(t){t(r)}),t.view.Scanner.hookupAttributes(e,r)})},getHooks:function(){var t=r.slice(0);return lastHookups=t,r=[],t},onlytxt:function(t,e){return u(e.call(t))},txt:function(s,o,c,f,l){var h=t.view.setupLists(),p=function(){},d=function(){g.unbind("change",p)},g=t.compute(l,f,!1);g.bind("change",p);var m=e.tagMap[o]||"span",_=h(),v=g();if(_)return"<"+m+t.view.hook(function(t,e){n.list(t,_.list,_.renderer,f,e)})+"></"+m+">";if(!g.hasDependencies||"function"==typeof v)return d(),(!s&&0===c||2===s?a:u)(v,0===c&&m);var b=e.tagToContentPropMap[o];if(0!==c||b){if(1===c)return r.push(function(t){n.attributes(t,g,g()),d()}),g();if(2===s){var y=c;return r.push(function(t){n.specialAttribute(t,y,g),d()}),g()}var y=0===c?b:c;return(0===c?lastHookups:r).push(function(t){n.attribute(t,y,g),d()}),n.attributePlaceholder}return"<"+m+t.view.hook(s?function(t,e){n.text(t,g,e),d()}:function(t,e){n.html(t,g,e),d()})+">"+i(m)+"</"+m+">"}}),t}(__m18,__m20,__m22,__m9),__m16=function(t){t.view.ext=".mustache";var e="scope",n="___h4sh",r="{scope:"+e+",options:options}",i=e+",options",a=/((([^\s]+?=)?('.*?'|".*?"))|.*?)\s/g,u=/^(('.*?'|".*?"|[0-9]+\.?[0-9]*|true|false|null|undefined)|((.+?)=(('.*?'|".*?"|[0-9]+\.?[0-9]*|true|false)|(.+))))$/,s=function(t){return'{get:"'+t.replace(/"/g,'\\"')+'"}'},o=function(t){return t&&"string"==typeof t.get},c=function(e){return e instanceof t.Map||e&&!!e._get},f=function(t){return t&&t.splice&&"number"==typeof t.length},l=function(e,n,r){return function(i,a){return null==i||i instanceof t.view.Scope||(i=n.add(i)),null==a||a instanceof d||(a=r.add(a)),e(i,a||r)}};Mustache=function(e){if(this.constructor!=Mustache){var n=new Mustache(e);return function(t,e){return n.render(t,e)}}return"function"==typeof e?(this.template={fn:e},undefined):(t.extend(this,e),this.template=this.scanner.scan(this.text,this.name),undefined)},t.Mustache=window.Mustache=Mustache,Mustache.prototype.render=function(e,n){return e instanceof t.view.Scope||(e=new t.view.Scope(e||{})),n instanceof d||(n=new d(n||{})),n=n||{},this.template.fn.call(e,e,n)},t.extend(Mustache.prototype,{scanner:new t.view.Scanner({text:{start:"",scope:e,options:",options: options",argNames:i},tokens:[["returnLeft","{{{","{{[{&]"],["commentFull","{{!}}","^[\\s\\t]*{{!.+?}}\\n"],["commentLeft","{{!","(\\n[\\s\\t]*{{!|{{!)"],["escapeFull","{{}}","(^[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}\\n|\\n[\\s\\t]*{{[#/^][^}]+?}}$)",function(t){return{before:/^\n.+?\n$/.test(t)?"\n":"",content:t.match(/\{\{(.+?)\}\}/)[1]||""}}],["escapeLeft","{{"],["returnRight","}}}"],["right","}}"]],helpers:[{name:/^>[\s]*\w*/,fn:function(e){var n=t.trim(e.replace(/^>\s?/,"")).replace(/["|']/g,"");return"can.Mustache.renderPartial('"+n+"',"+i+")"}},{name:/^\s*data\s/,fn:function(t){var n=t.match(/["|'](.*)["|']/)[1];return"can.proxy(function(__){can.data(can.$(__),'"+n+"', this.attr('.')); }, "+e+")"}},{name:/\s*\(([\$\w]+)\)\s*->([^\n]*)/,fn:function(t){var n=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,r=t.match(n);return"can.proxy(function(__){var "+r[1]+"=can.$(__);with("+e+".attr('.')){"+r[2]+"}}, this);"}},{name:/^.*$/,fn:function(e,o){var c=!1,f=[];if(e=t.trim(e),e.length&&(c=e.match(/^([#^/]|else$)/))){switch(c=c[0]){case"#":case"^":o.specialAttribute?f.push(o.insert+"can.view.onlytxt(this,function(){ return "):f.push(o.insert+"can.view.txt(0,'"+o.tagName+"',"+o.status+",this,function(){ return ");break;case"/":return{raw:'return ___v1ew.join("");}}])}));'}}e=e.substring(1)}if("else"!=c){var l,h=[],p=0;f.push("can.Mustache.txt(\n"+r+",\n"+(c?'"'+c+'"':"null")+",");var h=[],d=[];(t.trim(e)+" ").replace(a,function(t,e){p&&(l=e.match(u))?l[2]?h.push(l[0]):d.push(l[4]+":"+(l[6]?l[6]:s(l[5]))):h.push(s(e)),p++}),f.push(h.join(",")),d.length&&f.push(",{"+n+":{"+d.join(",")+"}}")}switch(c&&"else"!=c&&f.push(",[\n\n"),c){case"#":f.push("{fn:function("+i+"){var ___v1ew = [];");break;case"else":f.push('return ___v1ew.join("");}},\n{inverse:function('+i+"){\nvar ___v1ew = [];");break;case"^":f.push("{inverse:function("+i+"){\nvar ___v1ew = [];");break;default:f.push(")")}return f=f.join(""),c?{raw:f}:f}}]})});for(var h=t.view.Scanner.prototype.helpers,p=0;h.length>p;p++)Mustache.prototype.scanner.helpers.unshift(h[p]);Mustache.txt=function(e,r,i){for(var a,u=e.scope,s=e.options,h=[],p={fn:function(){},inverse:function(){}},d=u.attr("."),g=3;arguments.length>g;g++){var m=arguments[g];if(r&&t.isArray(m))p=t.extend.apply(t,[p].concat(m));else if(m&&m[n]){a=m[n];for(var _ in a)o(a[_])&&(a[_]=Mustache.get(a[_].get,e))}else m&&o(m)?h.push(Mustache.get(m.get,e,!1,!0)):h.push(m)}if(o(i)&&(i=Mustache.get(i.get,e,h.length,!1)),p.fn=l(p.fn,u,s),p.inverse=l(p.inverse,u,s),v=Mustache.getHelper(i,s)||t.isFunction(i)&&!i.isComputed&&!i.isObserveMethod&&{fn:i})return t.extend(p,{context:d,scope:u,contexts:u,hash:a}),h.push(p),v.fn.apply(d,h)||"";t.isFunction(i)&&(i.isComputed?i=i():i.isObserveMethod&&(i=i(d,u)));var g,v,b,m,y=h.length?h:[i],x=!0,w=[];if(r)for(g=0;y.length>g;g++)m=y[g],b=m!==undefined&&c(m),f(m)?"#"==r?x=x&&!!(b?m.attr("length"):m.length):"^"==r&&(x=x&&!(b?m.attr("length"):m.length)):x="#"==r?x&&!!m:"^"==r?x&&!m:x;if(x)switch(r){case"#":if(f(i)){var k=c(i);for(g=0;i.length>g;g++)w.push(p.fn(i[g]||"")),k&&i.attr(""+g);return w.join("")}return p.fn(i||{})||"";case"^":return p.inverse(i||{})||"";default:return""+(i!==undefined?i:"")}return""},Mustache.get=function(e,n,r,i){if(r){if(Mustache.getHelper(e,n.options))return e;if(n.scope&&t.isFunction(n.scope.attr(".")[e]))return n.scope.attr(".")[e]}var a=n.options||{},u=n.scope.get(e);if(Mustache.getHelper(e,a)&&u.scope!=n.scope)return e;if(i){if(t.isFunction(u.value))return u.value.isComputed?u.value:function(){return u.value.apply(u.parent,arguments)};if(c(u.parent))return u.parent.compute(u.name)}if(u.value&&c(u.value)&&f(u.value)&&u.value.attr("length"),t.isFunction(u.value)&&c(u.parent)&&u.parent.constructor.prototype[u.name]===u.value){var s=t.proxy(u.value,u.parent);return s.isObserveMethod=!0,s}return u.parent&&c(u.parent)?u.parent.compute(u.name):t.isFunction(u.value)?u.value.call(u.parent):u.value},Mustache.resolve=function(e,n,r,i){return n&&t.isFunction(n[r])&&i?n[r].isComputed?n[r]:function(){return n[r].apply(n,arguments)}:n&&t.isFunction(n)&&n.isComputed?n()[r]:n&&t.isFunction(n[r])?n[r]():c(e)&&f(e)&&e.attr("length")?e:n&&c(n)?n.compute(r):t.isFunction(e)?e():e};var d=t.view.Scope.extend({init:function(e){e.helpers||e.partials||(e={helpers:e}),t.view.Scope.prototype.init.apply(this,arguments)}});return Mustache._helpers={},Mustache.registerHelper=function(t,e){this._helpers[t]={name:t,fn:e}},Mustache.getHelper=function(t,e){var n=e.attr("helpers."+t);return n?{fn:n}:this._helpers[t]},Mustache.render=function(e,n){return!t.view.cached[e]&&n.attr("partial")&&(e=n.attr("partial")),t.view.render(e,n)},Mustache.renderPartial=function(e,n,r){var i=r.attr("partials."+e);return i?i.render?i.render(n,r):i(n,r):t.Mustache.render(e,n,r)},t.each({"if":function(t,e){return Mustache.resolve(t)?e.fn(e.contexts||this):e.inverse(e.contexts||this)},unless:function(t,e){return Mustache.resolve(t)?undefined:e.fn(e.contexts||this)},each:function(e,n){if(e=Mustache.resolve(e),e&&f(e)){if(c(e)&&e.attr("length")!==undefined)return t.view.lists&&t.view.lists(e,function(t){return n.fn(t)});for(var r=[],i=0;e.length>i;i++)r.push(n.fn(e[i]));return r.join("")}},"with":function(t,e){var n=t;return t=Mustache.resolve(t),t?e.fn(n):undefined}},function(t,e){Mustache.registerHelper(e,t)}),t.view.register({suffix:"mustache",contentType:"x-mustache-template",script:function(t,e){return"can.Mustache(function("+i+") { "+new Mustache({text:e,name:t}).template.out+" })"},renderer:function(t,e){return Mustache({text:e,name:t})}}),t}(__m2,__m17,__m18,__m19,__m15,__m21),__m24=function(t){t.view.Scanner.attribute("can-value",function(e,i){var a=i.getAttribute("can-value"),u=e.scope.compute(a);if("input"===i.nodeName.toLowerCase()){if("checkbox"===i.type){if(i.hasAttribute("can-true-value"))var s=e.scope.compute(i.getAttribute("can-true-value"));else var s=t.compute(!0);if(i.hasAttribute("can-false-value"))var o=e.scope.compute(i.getAttribute("can-false-value"));else var o=t.compute(!1)}if("checkbox"===i.type||"radio"===i.type)return new r(i,{value:u,trueValue:s,falseValue:o}),undefined}new n(i,{value:u})});var e={enter:function(t,e,n){return{event:"keyup",handler:function(t){return 13==t.keyCode?n.call(this,t):undefined}}}};t.view.Scanner.attribute(/can-[\w\.]+/,function(n,r){var i=n.attr.substr("can-".length),a=r.getAttribute(n.attr),u=n.scope.get(a),s=function(e){return u.value.call(u.parent,n.scope.attr("."),t.$(this),e)};if(e[i]){var o=e[i](n,r,s);s=o.handler,i=o.event}t.bind.call(r,i,s),t.bind.call(r,"removed",function(){t.unbind.call(r,i,s)})});var n=t.Control.extend({init:function(){"SELECT"===this.element[0].nodeName.toUpperCase()?setTimeout($.proxy(this.set,this),1):this.set()},"{value} change":"set",set:function(){this.element[0].value=this.options.value()},change:function(){this.options.value(this.element[0].value)}}),r=t.Control.extend({init:function(){this.isCheckebox="checkbox"==this.element[0].type.toLowerCase(),this.check()},"{value} change":"check","{trueValue} change":"check","{falseValue} change":"check",check:function(){if(this.isCheckebox){var t=this.options.value(),e=this.options.trueValue()||!0;this.options.falseValue()||!1,this.element[0].checked=t==e}else this.element[0].checked=this.options.value()===this.element[0].value?!0:!1},change:function(){this.isCheckebox?this.options.value(this.element[0].checked?this.options.trueValue():this.options.falseValue()):this.element[0].checked&&this.options.value(this.element[0].value)}})}(__m2,__m16,__m7),__m1=function(t){var e=/data-view-id|class|id/i,n=t.Component=t.Construct.extend({setup:function(){if(t.Construct.setup.apply(this,arguments),t.Component){var e=this;this.Control=t.Control.extend({_lookup:function(t){return[t.scope,t,window]}},t.extend({setup:function(e,n){var r=t.Control.prototype.setup.call(this,e,n);this.scope=n.scope;var i=this;return this.on(this.scope,"change",function(){i.on(),i.on(this.scope,"change",arguments.callee)}),r}},this.prototype.events));var n={};if(t.each(this.prototype.scope,function(t,e){"@"===t&&(n[e]=e)}),this.attributeScopeMappings=n,this.prototype.scope&&"object"!=typeof this.prototype.scope||(this.Map=t.Map.extend(this.prototype.scope||{})),this.prototype.template)if("function"==typeof this.prototype.template){var r=this.prototype.template;this.renderer=function(){return t.view.frag(r.apply(null,arguments))}}else this.renderer=t.view.mustache(this.prototype.template);t.view.Scanner.tag(this.prototype.tag,function(t,n){new e(t,n)})}}},{setup:function(n,r){var i={},a=this;t.each(this.constructor.attributeScopeMappings,function(t,e){i[e]=n.getAttribute(t)}),t.each(t.makeArray(n.attributes),function(s){var o=s.nodeName.toLowerCase(),c=s.value;if(!a.constructor.attributeScopeMappings[o]&&!e.test(o)){var f=r.scope.attr(c);if(t.isFunction(f)&&!f.isComputed){var l=r.scope.get(c);f=l.value.call(l.parent)}i[o]=f;var h=r.scope.compute(c),p=function(t,e){u.attr(o,e)};h&&(h.bind("change",p),t.bind.call(n,"removed",function(){h.unbind("change",p)}))}});var u;if(this.constructor.Map)u=new this.constructor.Map(i);else if(t.isFunction(this.scope)){var s=this.scope(i,r.scope,n);u=s instanceof t.Map?s:"function"==typeof s&&"function"==typeof s.extend?new s(i):new(t.Map.extend(s))(i)}this.scope=u,t.data(t.$(n),"scope",this.scope);var o=r.scope.add(this.scope),c=this.helpers||{};if(t.each(c,function(e,n){t.isFunction(e)&&(c[n]=function(){return e.apply(u,arguments)})}),this._control=new this.constructor.Control(n,{scope:this.scope}),this.constructor.renderer){c._tags||(c._tags={}),c._tags.content=function(e,n){var i=r.subtemplate||n.subtemplate;if(i){var a=t.view.frag(i(o,n.options.add(c)));t.insertBefore(e.parentNode,a,e),t.remove(t.$(e))}};var f=this.constructor.renderer(o,c)}else var f=t.view.frag(r.subtemplate?r.subtemplate(o,r.options.add(c)):"");t.appendChild(n,f)}});return window.$&&$.fn&&($.fn.scope=function(t){return t?this.data("scope").attr(t):this.data("scope")}),t.scope=function(e,n){var e=t.$(e);return n?t.data(e,"scope").attr(n):t.data(e,"scope")},n}(__m2,__m7,__m10,__m16,__m24),__m25=function(t){var e=function(e,n,r){var i=new t.Deferred;return e.then(function(){var e=t.makeArray(arguments),a=!0;try{e[0]=n[r](e[0])}catch(u){a=!1,i.rejectWith(i,[u].concat(e))}a&&i.resolveWith(i,e)},function(){i.rejectWith(this,arguments)}),"function"==typeof e.abort&&(i.abort=function(){return e.abort()}),i},n=0,r=function(e){return t.__reading&&t.__reading(e,e.constructor.id),e.__get(e.constructor.id)},i=function(e,n,r,i,a,u){var s={};if("string"==typeof e){var o=e.split(/\s+/);s.url=o.pop(),o.length&&(s.type=o.pop())}else t.extend(s,e);return s.data="object"!=typeof n||t.isArray(n)?n:t.extend(s.data||{},n),s.url=t.sub(s.url,s.data,!0),t.ajax(t.extend({type:r||"post",dataType:i||"json",success:a,error:u},s))},a=function(e,n,i,a,u){var s;t.isArray(e)?(s=e[1],e=e[0]):s=e.serialize(),s=[s];var o,c,f=e.constructor;return"create"!==n&&s.unshift(r(e)),c=f[n].apply(f,s),o=c.pipe(function(t){return e[u||n+"d"](t,c),e}),c.abort&&(o.abort=function(){c.abort()}),o.then(i,a),o},u={models:function(e){return function(n,r){if(t.Model._reqs++,n){if(n instanceof this.List)return n;var i=this,a=[],u=r instanceof t.List?r:new(i.List||s),o=t.isArray(n),c=n instanceof s,f=o?n:c?n.serialize():t.getObject(e||"data",n);if(f===undefined)throw Error("Could not get any raw data while converting using .models");return u.length&&u.splice(0),t.each(f,function(t){a.push(i.model(t))}),u.push.apply(u,a),o||t.each(n,function(t,e){"data"!==e&&u.attr(e,t)}),setTimeout(t.proxy(this._clean,this),1),u}}},model:function(e){return function(n){if(n){"function"==typeof n.serialize&&(n=n.serialize()),e&&(n=t.getObject(e||"data",n));var r=n[this.id],i=(r||0===r)&&this.store[r]?this.store[r].attr(n,this.removeAttr||!1):new this(n);return i}}}};ajaxMethods={create:{url:"_shortName",type:"post"},update:{data:function(e,n){n=n||{};var r=this.id;return n[r]&&n[r]!==e&&(n["new"+t.capitalize(e)]=n[r],delete n[r]),n[r]=e,n},type:"put"},destroy:{type:"delete",data:function(t,e){return e=e||{},e.id=e[this.id]=t,e}},findAll:{url:"_shortName"},findOne:{}},ajaxMaker=function(t,e){return function(n){return n=t.data?t.data.apply(this,arguments):n,i(e||this[t.url||"_url"],n,t.type||"get")}},t.Model=t.Map({fullName:"can.Model",_reqs:0,setup:function(e){if(this.store={},t.Map.setup.apply(this,arguments),t.Model){this.List=s({Map:this},{});var r=this,i=t.proxy(this._clean,r);t.each(ajaxMethods,function(n,a){if(t.isFunction(r[a])||(r[a]=ajaxMaker(n,r[a])),r["make"+t.capitalize(a)]){var u=r["make"+t.capitalize(a)](r[a]);t.Construct._overwrite(r,e,a,function(){t.Model._reqs++;var e=u.apply(this,arguments),n=e.then(i,i);return n.abort=e.abort,n})}}),t.each(u,function(n,i){"string"==typeof r[i]&&t.Construct._overwrite(r,e,i,n(r[i]))}),"can.Model"!=r.fullName&&r.fullName||(r.fullName="Model"+ ++n),t.Model._reqs=0,this._url=this._shortName+"/{"+this.id+"}"}},_ajax:ajaxMaker,_makeRequest:a,_clean:function(){if(t.Model._reqs--,!t.Model._reqs)for(var e in this.store)this.store[e]._bindings||delete this.store[e];return arguments[0]},models:u.models("data"),model:u.model()},{setup:function(e){var n=e&&e[this.constructor.id];t.Model._reqs&&null!=n&&(this.constructor.store[n]=this),t.Map.prototype.setup.apply(this,arguments)},isNew:function(){var t=r(this);return!(t||0===t)},save:function(t,e){return a(this,this.isNew()?"create":"update",t,e)},destroy:function(e,n){if(this.isNew()){var r=this,i=t.Deferred();return i.then(e,n),i.done(function(t){r.destroyed(t)}).resolve(r)}return a(this,"destroy",e,n,"destroyed")},_bindsetup:function(){return this.constructor.store[this.__get(this.constructor.id)]=this,t.Map.prototype._bindsetup.apply(this,arguments)},_bindteardown:function(){return delete this.constructor.store[r(this)],t.Map.prototype._bindteardown.apply(this,arguments)},___set:function(e,n){t.Map.prototype.___set.call(this,e,n),e===this.constructor.id&&this._bindings&&(this.constructor.store[r(this)]=this)}}),t.each({makeFindAll:"models",makeFindOne:"model",makeCreate:"model",makeUpdate:"model"},function(n,r){t.Model[r]=function(r){return function(){var i=t.makeArray(arguments),a=t.isFunction(i[1])?i.splice(0,1):i.splice(0,2),u=e(r.apply(this,a),this,n);return u.then(i[0],i[1]),u}}}),t.each(["created","updated","destroyed"],function(e){t.Model.prototype[e]=function(n){var r,i=this.constructor;r=n&&"object"==typeof n&&this.attr(n.attr?n.attr():n),t.trigger(this,"change",e),t.trigger(i,e,this)}});var s=t.Model.List=t.List({setup:function(e){t.isPlainObject(e)&&!t.isArray(e)?(t.List.prototype.setup.apply(this),this.replace(this.constructor.Map.findAll(e))):t.List.prototype.setup.apply(this,arguments)},_changes:function(e,n){if(t.List.prototype._changes.apply(this,arguments),/\w+\.destroyed/.test(n)){var r=this.indexOf(e.target);-1!=r&&this.splice(r,1)}}});return t.Model}(__m2,__m11,__m14),__m27=function(t){var e=/^\d+$/,n=/([^\[\]]+)|(\[\])/g,r=/([^?#]*)(#.*)?$/,i=function(t){return decodeURIComponent(t.replace(/\+/g," "))};return t.extend(t,{deparam:function(a){var u,s,o={};return a&&r.test(a)&&(u=a.split("&"),t.each(u,function(t){var r=t.split("="),a=i(r.shift()),u=i(r.join("=")),c=o;if(a){r=a.match(n);for(var f=0,l=r.length-1;l>f;f++)c[r[f]]||(c[r[f]]=e.test(r[f+1])||"[]"==r[f+1]?[]:{}),c=c[r[f]];s=r.pop(),"[]"==s?c.push(u):c[s]=u}})),o}}),t}(__m2,__m9),__m26=function(t){var e,n,r,i,a=/\:([\w\.]+)/g,u=/^(?:&[^=]+=[^&]*)+/,s=function(e){var n=[];return t.each(e,function(e,r){n.push(("className"===r?"class":r)+'="'+("href"===r?e:t.esc(e))+'"')}),n.join(" ")},o=function(t,e){var n=0,r=0,i={};for(var a in t.defaults)t.defaults[a]===e[a]&&(i[a]=1,n++);for(;t.names.length>r;r++){if(!e.hasOwnProperty(t.names[r]))return-1;i[t.names[r]]||n++}return n},c=window.location,f=function(t){return(t+"").replace(/([.?*+\^$\[\]\\(){}|\-])/g,"\\$1")},l=t.each,h=t.extend,p=function(e){return e&&"object"==typeof e?(e=e instanceof t.Map?e.attr():t.isFunction(e.slice)?e.slice():t.extend({},e),t.each(e,function(t,n){e[n]=p(t)})):e!==undefined&&null!==e&&t.isFunction(e.toString)&&(e=""+e),e},d=function(t){return t.replace(/\\/g,"")},g=function(){i=1,clearTimeout(e),e=setTimeout(function(){i=0;var e=t.route.data.serialize(),n=t.route.param(e,!0);t.route._call("setURL",n),r=n},10)};t.route=function(e,n){var r=t.route._call("root");r.lastIndexOf("/")==r.length-1&&0===e.indexOf("/")&&(e=e.substr(1)),n=n||{};for(var i,u,s=[],o="",c=a.lastIndex=0,l=t.route._call("querySeparator");i=a.exec(e);)s.push(i[1]),o+=d(e.substring(c,a.lastIndex-i[0].length)),u="\\"+(d(e.substr(a.lastIndex,1))||l),o+="([^"+u+"]"+(n[i[1]]?"*":"+")+")",c=a.lastIndex;return o+=e.substr(c).replace("\\",""),t.route.routes[e]={test:RegExp("^"+o+"($|"+f(l)+")"),route:e,names:s,defaults:n,length:e.split("/").length},t.route},h(t.route,{param:function(e,n){var r,i,u=0,s=e.route,c=0;if(delete e.route,l(e,function(){c++}),l(t.route.routes,function(t){return i=o(t,e),i>u&&(r=t,u=i),i>=c?!1:undefined}),t.route.routes[s]&&o(t.route.routes[s],e)===u&&(r=t.route.routes[s]),r){var f,p=h({},e),d=r.route.replace(a,function(t,n){return delete p[n],e[n]===r.defaults[n]?"":encodeURIComponent(e[n])}).replace("\\","");return l(r.defaults,function(t,e){p[e]===t&&delete p[e]}),f=t.param(p),n&&t.route.attr("route",r.route),d+(f?t.route._call("querySeparator")+f:"")}return t.isEmptyObject(e)?"":t.route._call("querySeparator")+t.param(e)},deparam:function(e){var n=t.route._call("root");n.lastIndexOf("/")==n.length-1&&0===e.indexOf("/")&&(e=e.substr(1));var r={length:-1},i=t.route._call("querySeparator"),a=t.route._call("paramsMatcher");if(l(t.route.routes,function(t){t.test.test(e)&&t.length>r.length&&(r=t)}),r.length>-1){var u=e.match(r.test),s=u.shift(),o=e.substr(s.length-(u[u.length-1]===i?1:0)),c=o&&a.test(o)?t.deparam(o.slice(1)):{};return c=h(!0,{},r.defaults,c),l(u,function(t,e){t&&t!==i&&(c[r.names[e]]=decodeURIComponent(t))}),c.route=r.route,c}return e.charAt(0)!==i&&(e=i+e),a.test(e)?t.deparam(e.slice(1)):{}},data:new t.Map({}),routes:{},ready:function(e){return e!==!0&&(t.route._setup(),t.route.setState()),t.route},url:function(e,n){return n&&(e=t.extend({},t.route.deparam(t.route._call("matchingPartOfURL")),e)),t.route._call("root")+t.route.param(e)},link:function(e,n,r,i){return"<a "+s(h({href:t.route.url(n,i)},r))+">"+e+"</a>"},current:function(e){return this._call("matchingPartOfURL")===t.route.param(e)},bindings:{hashchange:{paramsMatcher:u,querySeparator:"&",bind:function(){t.bind.call(window,"hashchange",m)},unbind:function(){t.unbind.call(window,"hashchange",m)},matchingPartOfURL:function(){return c.href.split(/#!?/)[1]||""},setURL:function(t){return c.hash="#!"+t,t},root:"#!"}},defaultBinding:"hashchange",currentBinding:null,_setup:function(){t.route.currentBinding||(t.route._call("bind"),t.route.bind("change",g),t.route.currentBinding=t.route.defaultBinding)},_teardown:function(){t.route.currentBinding&&(t.route._call("unbind"),t.route.unbind("change",g),t.route.currentBinding=null),clearTimeout(e),i=0},_call:function(){var e=t.makeArray(arguments),n=e.shift(),r=t.route.bindings[t.route.currentBinding||t.route.defaultBinding];return method=r[n],"function"==typeof method?method.apply(r,e):method}}),l(["bind","unbind","on","off","delegate","undelegate","removeAttr","compute","_get","__get"],function(e){t.route[e]=function(){return t.route.data[e]?t.route.data[e].apply(t.route.data,arguments):undefined}}),t.route.attr=function(e,n){var r,i=typeof e;return r=n===undefined?arguments:"string"!==i&&"number"!==i?[p(e),n]:[e,p(n)],t.route.data.attr.apply(t.route.data,r)};var m=t.route.setState=function(){var e=t.route._call("matchingPartOfURL");n=t.route.deparam(e),i&&e===r||t.route.attr(n,!0)};return t.route}(__m2,__m11,__m27),__m28=function(t){return t.Control.processors.route=function(e,n,r,i,a){r=r||"",t.route.routes[r]||t.route(r);var u,s=function(e){if(t.route.attr("route")===r&&(e.batchNum===undefined||e.batchNum!==u)){u=e.batchNum;var n=t.route.attr();delete n.route,t.isFunction(a[i])?a[i](n):a[a[i]](n)}};return t.route.bind("change",s),function(){t.route.unbind("change",s)}},t}(__m2,__m26,__m7),__m29=function(t){var e=t.extend,n=function(t){if(this.constructor!=n){var r=new n(t);return function(t,e){return r.render(t,e)}}return"function"==typeof t?(this.template={fn:t},undefined):(e(this,t),this.template=this.scanner.scan(this.text,this.name),undefined)};return t.EJS=n,n.prototype.render=function(t,e){return t=t||{},this.template.fn.call(t,t,new n.Helpers(t,e||{}))},e(n.prototype,{scanner:new t.view.Scanner({text:{outStart:"with(_VIEW) { with (_CONTEXT) {",outEnd:"}}",argNames:"_CONTEXT,_VIEW"},tokens:[["templateLeft","<%%"],["templateRight","%>"],["returnLeft","<%=="],["escapeLeft","<%="],["commentLeft","<%#"],["left","<%"],["right","%>"],["returnRight","%>"]],helpers:[{name:/\s*\(([\$\w]+)\)\s*->([^\n]*)/,fn:function(t){var e=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,n=t.match(e);return"can.proxy(function(__){var "+n[1]+"=can.$(__);"+n[2]+"}, this);"}}],transform:function(t){return t.replace(/<%([\s\S]+?)%>/gm,function(t,e){var n,r,i=[];e.replace(/[{}]/gm,function(t,e){i.push([t,e])});do for(n=!1,r=i.length-2;r>=0;r--)if("{"==i[r][0]&&"}"==i[r+1][0]){i.splice(r,2),n=!0;break}while(n);if(i.length>=2){var a,u=["<%"],s=0;for(r=0;a=i[r];r++)u.push(e.substring(s,s=a[1])),"{"==a[0]&&i.length-1>r||"}"==a[0]&&r>0?u.push("{"==a[0]?"{ %><% ":" %><% }"):u.push(a[0]),++s;return u.push(e.substring(s),"%>"),u.join("")}return"<%"+e+"%>"})}})}),n.Helpers=function(t,n){this._data=t,this._extras=n,e(this,n)},n.Helpers.prototype={list:function(e,n){t.each(e,function(t,r){n(t,r,e)})},each:function(e,n){t.isArray(e)?this.list(e,n):t.view.lists(e,n)}},t.view.register({suffix:"ejs",script:function(t,e){return"can.EJS(function(_CONTEXT,_VIEW) { "+new n({text:e,name:t}).template.out+" })"},renderer:function(t,e){return n({text:e,name:t})}}),t}(__m2,__m18,__m9,__m15,__m19,__m21),__m32=function(t){var e=t.isArray,n=function(t){var e=0;for(var n in t)e++;return e};t.Object={};var r=t.Object.same=function(n,a,u,s,o,c){var f,l=typeof n,h=e(n),p=typeof u;if(("string"==p||null===u)&&(u=i[u],p="function"),"function"==p)return u(n,a,s,o);if(u=u||{},n instanceof Date)return n===a;if(-1===c)return"object"===l||n===a;if(l!==typeof a||h!==e(a))return!1;if(n===a)return!0;if(h){if(n.length!==a.length)return!1;for(var d=0;n.length>d;d++)if(f=u[d]===undefined?u["*"]:u[d],!r(n[d],a[d],n,a,f))return!1;return!0}if("object"===l||"function"===l){var g=t.extend({},a);for(var m in n){if(f=u[m]===undefined?u["*"]:u[m],!r(n[m],a[m],f,n,a,c===!1?-1:undefined))return!1;delete g[m]}for(m in g)if(u[m]===undefined||!r(undefined,a[m],u[m],n,a,c===!1?-1:undefined))return!1;return!0}return!1};t.Object.subsets=function(e,r,i){var a=r.length,u=[];n(e);for(var s=0;a>s;s++){var o=r[s];t.Object.subset(e,o,i)&&u.push(o)}return u},t.Object.subset=function(t,e,n){var n=n||{};for(var i in e)if(!r(t[i],e[i],n[i],t,e))return!1;return!0};var i={"null":function(){return!0},i:function(t,e){return(""+t).toLowerCase()==(""+e).toLowerCase()}};return t.Object}(__m2),__m31=function(t){var e=function(t){var e={};for(var n in t)("object"!=typeof t[n]||null===t[n]||t[n]instanceof Date)&&(e[n]=t[n]);return e};return t.extend(t.Map.prototype,{backup:function(){return this._backupStore=this._attrs(),this},isDirty:function(e){return this._backupStore&&!t.Object.same(this._attrs(),this._backupStore,undefined,undefined,undefined,!!e)},restore:function(t){var n=t?this._backupStore:e(this._backupStore);return this.isDirty(t)&&this._attrs(n),this}}),t.Map}(__m2,__m11,__m32),__m30=function(t){var e=function(e,n){var r,i,a=t.extend(!0,{},n);if(e)for(var u=0;e.length>u;u++){for(r=a,i=e[u].split(".");i.length>1;)r=r&&r[i.shift()];r&&delete r[i.shift()]}return a},n=function(e,n,r,i){this._changedAttrs=this._changedAttrs||[];var a,u,s=new t.Deferred,o=this,c=this.attr(),f=this._requestQueue,l=this._changedAttrs;return a=function(t,e,n,r){return function(){return t.constructor._makeRequest([t,c],e||(t.isNew()?"create":"update"),n,r,i)}}(this,r,function(){s.resolveWith(o,arguments),f.splice(0,1),f.length>0?f[0]=f[0]():l.splice(0)},function(){s.rejectWith(o,arguments),f.splice(0),l.splice(0)}),u=f.push(a)-1,1===f.length&&(f[0]=f[0]()),s.abort=function(){var t;return t=f[u].abort&&f[u].abort(),f.splice(u),0===f.length&&l.splice(0),t},s.then(e,n),s},r=t.Model.prototype._changes,i=t.Model.prototype.destroy,a=t.Model.prototype.setup;return t.each(["created","updated","destroyed"],function(n){var r=t.Model.prototype[n];t.Model.prototype[n]=function(t){t&&"object"==typeof t&&(t=t.attr?t.attr():t,this._backupStore=t,t=e(this._changedAttrs||[],t)),r.call(this,t)}}),t.extend(t.Model.prototype,{setup:function(){a.apply(this,arguments),this._requestQueue=new t.List},_changes:function(t,e){this._changedAttrs&&this._changedAttrs.push(e),r.apply(this,arguments)},hasQueuedRequests:function(){return this._requestQueue.attr("length")>1},save:function(){return n.apply(this,arguments)},destroy:function(t,e){return this.isNew()?i.call(this,t,e):n.call(this,t,e,"destroy","destroyed")}}),t}(__m2,__m25,__m31),__m33=function(t,e){var n,r,i,a,u,s,o={val:!0,text:!0};
return n=function(n){var a=t.fn[n];t.fn[n]=function(){var t,u,c,f=e.makeArray(arguments),l=this;if(e.isDeferred(f[0]))return f[0].done(function(t){r.call(l,[t],a)}),this;if(i(f)){if(t=s(f))return u=f[t],f[t]=function(t){r.call(l,[t],a),u.call(l,t)},e.view.apply(e.view,f),this;if(c=e.view.apply(e.view,f),e.isDeferred(c))return c.done(function(t){r.call(l,[t],a)}),this;f=[c]}return o[n]?a.apply(this,f):r.call(this,f,a)}},r=function(t,n){var r;for(var i in e.view.hookups)break;return i&&t[0]&&a(t[0])&&(t[0]=e.view.frag(t[0]).childNodes),r=n.apply(this,t)},i=function(t){var e=typeof t[1];return"string"==typeof t[0]&&("object"==e||"function"==e)&&!u(t[1])},u=function(t){return t.nodeType||t[0]&&t[0].nodeType},a=function(t){return u(t)?!0:"string"==typeof t?(t=e.trim(t),"<"===t.substr(0,1)&&">"===t.substr(t.length-1,1)&&t.length>=3):!1},s=function(t){return"function"==typeof t[3]?3:"function"==typeof t[2]&&2},t.fn.hookup=function(){return e.view.frag(this),this},e.each(["prepend","append","after","before","text","html","replaceWith","val"],function(t){n(t)}),e}(jQuery,__m18),__m34=function(t){var e=function(e){return"undefined"!=typeof steal?t.isFunction(steal.config)?""+steal.config().root.mapJoin(e):""+steal.root.join(e):(t.fixture.rootUrl||"")+e},n=function(n,r){if(t.fixture.on){var i=function(){"undefined"!=typeof steal&&steal.dev&&steal.dev.log("fixture INFO: "+Array.prototype.slice.call(arguments).join(" "))};n.type=n.type||n.method||"GET";var a=o(n);if(!n.fixture)return"file:"===window.location.protocol&&i("ajax request to "+n.url+", no fixture found"),undefined;if("string"==typeof n.fixture&&t.fixture[n.fixture]&&(n.fixture=t.fixture[n.fixture]),"string"==typeof n.fixture){var u=n.fixture;/^\/\//.test(u)&&(u=e(n.fixture.substr(2))),a&&(u=t.sub(u,a)),delete n.fixture,n.url=u,n.data=null,n.type="GET",n.error||(n.error=function(t,e,n){throw"fixtures.js Error "+e+" "+n})}else n.dataTypes&&n.dataTypes.splice(0,0,"fixture"),a&&r&&t.extend(r.data,a)}},r=function(t,e,n,r){return"number"!=typeof t&&(r=e,n=t,e="success",t=200),"string"!=typeof e&&(r=n,n=e,e="success"),t>=400&&599>=t&&(this.dataType="text"),[t,e,i(this,n),r]},i=function(t,e){var n=t.dataTypes?t.dataTypes[0]:t.dataType||"json";if(!e||!e[n]){var r={};r[n]=e,e=r}return e};if(t.ajaxPrefilter&&t.ajaxTransport)t.ajaxPrefilter(n),t.ajaxTransport("fixture",function(e,n){e.dataTypes.shift();var a,u=!1;return{send:function(s,o){a=setTimeout(function(){var t=function(){u===!1&&o.apply(null,r.apply(e,arguments))},a=e.fixture(n,t,s,e);a!==undefined&&o(200,"success",i(e,a),{})},t.fixture.delay)},abort:function(){u=!0,clearTimeout(a)}}});else{var a=t.ajax;t.ajax=function(e){if(n(e,e),e.fixture){var i,u=new t.Deferred,s=!1;return u.getResponseHeader=function(){},u.then(e.success,e.fail),u.abort=function(){clearTimeout(i),s=!0,u.reject(u)},i=setTimeout(function(){var t=function(){var t=r.apply(e,arguments),n=t[0];(n>=200&&300>n||304===n)&&s===!1?u.resolve(t[2][e.dataType]):u.reject(u,"error",t[1])},n=e.fixture(e,t,e.headers,e);n!==undefined&&u.resolve(n)},t.fixture.delay),u}return a(e)}}var u=[],s=function(t,e){for(var n=0;u.length>n;n++)if(f._similar(t,u[n],e))return n;return-1},o=function(t){var e=s(t);return e>-1?(t.fixture=u[e].fixture,f._getData(u[e].url,t.url)):undefined},c=function(t){var e=t.data.id;return e===undefined&&"number"==typeof t.data&&(e=t.data),e===undefined&&t.url.replace(/\/(\d+)(\/|$|\.)/g,function(t,n){e=n}),e===undefined&&(e=t.url.replace(/\/(\w+)(\/|$|\.)/g,function(t,n){"update"!=n&&(e=n)})),e===undefined&&(e=Math.round(1e3*Math.random())),e},f=t.fixture=function(e,n){if(n!==undefined){if("string"==typeof e){var r=e.match(/(GET|POST|PUT|DELETE) (.+)/i);e=r?{url:r[2],type:r[1]}:{url:e}}var i=s(e,!!n);if(i>-1&&u.splice(i,1),null==n)return;e.fixture=n,u.push(e)}else t.each(e,function(t,e){f(e,t)})},l=t.replacer;return t.extend(t.fixture,{_similar:function(e,n,r){return r?t.Object.same(e,n,{fixture:null}):t.Object.subset(e,n,t.fixture._compare)},_compare:{url:function(t,e){return!!f._getData(e,t)},fixture:null,type:"i"},_getData:function(e,n){var r=[],i=e.replace(".","\\.").replace("?","\\?"),a=RegExp(i.replace(l,function(t,e){return r.push(e),"([^/]+)"})+"$").exec(n),u={};return a?(a.shift(),t.each(r,function(t){u[t]=a.shift()}),u):null},store:function(e,n,r,i){var a=[],u=0,s=function(t){for(var e=0;a.length>e;e++)if(t==a[e].id)return a[e]},o={};"string"==typeof e?e=[e+"s",e]:t.isArray(e)||(i=r,r=n,n=e),t.extend(o,{findAll:function(e){e=e||{};var n=a.slice(0);e.data=e.data||{},t.each((e.data.order||[]).slice(0).reverse(),function(t){var e=t.split(" ");n=n.sort(function(t,n){return"ASC"!==e[1].toUpperCase()?t[e[0]]<n[e[0]]?1:t[e[0]]==n[e[0]]?0:-1:t[e[0]]<n[e[0]]?-1:t[e[0]]==n[e[0]]?0:1})}),t.each((e.data.group||[]).slice(0).reverse(),function(t){var e=t.split(" ");n=n.sort(function(t,n){return t[e[0]]>n[e[0]]})});var r=parseInt(e.data.offset,10)||0,u=parseInt(e.data.limit,10)||a.length-r,s=0;for(var o in e.data)if(s=0,e.data[o]!==undefined&&(-1!=o.indexOf("Id")||-1!=o.indexOf("_id")))for(;n.length>s;)e.data[o]!=n[s][o]?n.splice(s,1):s++;if(i)for(s=0;n.length>s;)i(n[s],e)?s++:n.splice(s,1);return{count:n.length,limit:e.data.limit,offset:e.data.offset,data:n.slice(r,r+u)}},findOne:function(t,e){var n=s(c(t));e(n?n:undefined)},update:function(e,n){var r=c(e);t.extend(s(r),e.data),n({id:c(e)},{location:e.url||"/"+c(e)})},destroy:function(e){for(var n=c(e),r=0;a.length>r;r++)if(a[r].id==n){a.splice(r,1);break}return t.extend(s(n)||{},e.data),{}},create:function(e,n){var i=r(a.length,a);t.extend(i,e.data),i.id||(i.id=u++),a.push(i),n({id:i.id},{location:e.url+"/"+i.id})}});var f=function(){a=[];for(var i=0;n>i;i++){var s=r(i,a);s.id||(s.id=i),u=Math.max(s.id+1,u+1)||a.length,a.push(s)}t.isArray(e)&&(t.fixture["~"+e[0]]=a,t.fixture["-"+e[0]]=o.findAll,t.fixture["-"+e[1]]=o.findOne,t.fixture["-"+e[1]+"Update"]=o.update,t.fixture["-"+e[1]+"Destroy"]=o.destroy,t.fixture["-"+e[1]+"Create"]=o.create)};return f(),t.extend({getId:c,find:function(t){return s(c(t))},reset:f},o)},rand:function(t,e,n){if("number"==typeof t)return"number"==typeof e?t+Math.floor(Math.random()*(e-t)):Math.floor(Math.random()*t);var r=arguments.callee;if(e===undefined)return r(t,r(t.length+1));var i=[];t=t.slice(0),n||(n=e),n=e+Math.round(r(n-e));for(var a=0;n>a;a++)i.push(t.splice(r(t.length),1)[0]);return i},xhr:function(e){return t.extend({},{abort:t.noop,getAllResponseHeaders:function(){return""},getResponseHeader:function(){return""},open:t.noop,overrideMimeType:t.noop,readyState:4,responseText:"",responseXML:null,send:t.noop,setRequestHeader:t.noop,status:200,statusText:"OK"},e)},on:!0}),t.fixture.delay=200,t.fixture.rootUrl=e(""),t.fixture["-handleFunction"]=function(e){return"string"==typeof e.fixture&&t.fixture[e.fixture]&&(e.fixture=t.fixture[e.fixture]),"function"==typeof e.fixture?(setTimeout(function(){e.success&&e.success.apply(null,e.fixture(e,"success")),e.complete&&e.complete.apply(null,e.fixture(e,"complete"))},t.fixture.delay),!0):!1},t.fixture.overwrites=u,t.fixture.make=t.fixture.store,t.fixture}(__m2,__m9,__m32);window.can=__m4})();